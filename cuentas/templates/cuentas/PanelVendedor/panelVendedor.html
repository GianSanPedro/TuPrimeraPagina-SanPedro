{# cuentas/templates/cuentas/PanelVendedor/panelVendedor.html #}
{% extends "base.html" %}
{% block titulo %}ğŸš— Panel de Vendedor{% endblock %}

{% block contenido %}
<div class="container mt-4">

  {# â€” TÃ­tulo principal con emoticon â€” #}
  <h2 class="mb-4 text-center"> Panel de Vendedor</h2>

  {# â€” SubtÃ­tulo de la lista â€” #}
  <h4 class="mb-3">ğŸ“‹ Lista de vehÃ­culos disponibles</h4>
  {# â€” Filtros y botÃ³n â€œAgregar VehÃ­culoâ€ alineados â€” #}
  <form method="get" class="row g-2 mb-4">
    <div class="col-md-3">
      <input type="text" name="marca" class="form-control"
             placeholder="Marca" value="{{ filtro_marca }}">
    </div>
    <div class="col-md-3">
      <input type="text" name="modelo" class="form-control"
             placeholder="Modelo" value="{{ filtro_modelo }}">
    </div>
    <div class="col-md-3">
      <input type="text" name="tipo" class="form-control"
             placeholder="Tipo" value="{{ filtro_tipo }}">
    </div>
    <div class="col-md-1 d-grid">
      <button type="submit" class="btn btn-primary">
        ğŸ” Filtrar
      </button>
    </div>
    <div class="col-md-2 d-grid">
      <a href="{% url 'concesionaria:crear_vehiculo' %}"
         class="btn btn-success">
        + Agregar VehÃ­culo
      </a>
    </div>
  </form>

  {# â€” Lista de vehÃ­culos disponibles â€” #}
  {% if vehiculos_disponibles %}
    <div class="list-group">
      {% for v in vehiculos_disponibles %}
        <div class="list-group-item mb-3">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <strong>{{ v.modelo }}</strong> {{ v.marca }} - {{ v.tipo }}
            </div>
            <div class="btn-group">
              <a href="{% url 'concesionaria:editar_vehiculo' v.pk %}"
                 class="btn btn-sm btn-outline-secondary">
                âœï¸ Editar
              </a>
              <a href="{% url 'concesionaria:eliminar_vehiculo' v.pk %}"
                 class="btn btn-sm btn-outline-danger">
                ğŸ—‘ï¸ Eliminar
              </a>
              <button class="btn btn-sm btn-outline-info"
                      type="button"
                      data-bs-toggle="collapse"
                      data-bs-target="#det-{{ v.pk }}"
                      aria-expanded="false"
                      aria-controls="det-{{ v.pk }}">
                ğŸ” Ver mÃ¡s
              </button>
            </div>
          </div>

          <div class="collapse mt-3" id="det-{{ v.pk }}">
            <p><strong>AÃ±o:</strong> {{ v.aÃ±o }}</p>
            <p><strong>Precio:</strong> ${{ v.precio }}</p>
            <p>
              <strong>Disponible:</strong>
              {{ v.disponible|yesno:"SÃ­,No" }}
            </p>
            {% if v.foto %}
              <p><strong>Foto:</strong><br>
                <img src="{{ v.foto.url }}"
                     alt="Foto de {{ v }}"
                     class="img-fluid"
                     style="max-width:200px; object-fit:cover;">
              </p>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>No hay vehÃ­culos disponibles.</p>
  {% endif %}

  <hr class="my-5">

  {# â€” Ventas realizadas â€” #}
  <h3>ğŸ’¼ Ventas realizadas</h3>
  {% if ventas_realizadas %}
    <table class="table table-striped">
      <thead>
        <tr>
          <th>VehÃ­culo</th>
          <th>Cliente</th>
          <th>Precio</th>
          <th>Fecha</th>
        </tr>
      </thead>
      <tbody>
        {% for sale in ventas_realizadas %}
          <tr>
            <td>{{ sale.vehiculo }}</td>
            <td>{{ sale.cliente }}</td>
            <td>${{ sale.precio_final }}</td>
            <td>{{ sale.fecha }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>AÃºn no hay ventas realizadas.</p>
  {% endif %}

</div>
{% endblock %}
